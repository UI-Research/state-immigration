# State Immigration Policy Resource

This repo contains code for the tool [State Immigration Policy Resource](https://www.urban.org/features/state-immigration-policy-resource) that centralizes information on how key state-level policies have changed from 2000 to 2020.

## How to update

### Data inputs
The research team should provide three excel files for enforcement, public benefits, and integration data. In the `data` folder, there's the `state_squares.geojson` file, that will also be used to create the geojson that will feed the tool.

### Data processing
In the `source` folder, there are two R scripts: `set-up.R` and `generate-csv.R`.
- `set-up.R` loads the packages used to clean the data. It's not necessary to run it.
- `generate-geojson.R` takes the three excel files shared by the research team and creates a dataframe, then it merges the data with `state_squares.geojson` to create a geojson that includes the new data (`set-up.R` runs within this script).

### Tool text
As of February 2022, the text that explains each policy reads from `policy_descriptions_only.csv`, in the `data` folder. If researchers add new policies, this file needs to be updated manually. Not all fields are necessary.

**DISCLOSURE**
1. Original files built by the researchers might be named differently with every new update. Double-check the files' names and change, if necessary, in `generate-geojson.R` before running the code.
2. `set-up.R` and  `generate-geojson.R` were originally written to be run within an [R project](https://r4ds.had.co.nz/workflow-projects.html) and using a folder structure with three folders:
- `data-in`, it should include the original data sent by the research team and a copy of `state_squares.geojson`.
- `scripts`, it should include the `set-up.R` and `generate-geojson.R`.
- `data-out`, it should include the geojson (`combined-data.geojson`) generated by `generate-geojson.R`.

You can replicate that folder structure and create an R project â€“or use the [here](https://here.r-lib.org/) package instead. You can also rewrite the paths to make it work following whatever system you prefer.
